<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Lock_Opportunity_When_Pending_or_Signed</fullName>
    <active>true</active>
    <description>Lock entire record on signed</description>
    <errorConditionFormula>AND(
OR(
ISCHANGED( Total_Acquiring_Profit__c ),
ISCHANGED( Total_Charges__c ),
ISCHANGED( Total_DCC_Profit__c ), 
ISCHANGED( TF_Annual_Net_Commission1__c ),
ISCHANGED( Total_Subscription_Fees__c ),
ISCHANGED( Total_Hardware_Annualized_Recurring_Fees__c ),
ISCHANGED( Total_Hardware_One_Off_Cost__c),
ISCHANGED( StageName ),
ISCHANGED( CloseDate )
),
OR(
ISPICKVAL(PRIORVALUE(StageName),&quot;Contract Signed&quot;),
TEXT(Approval_Status__c) = &quot;Pending&quot;
),
NOT(CONTAINS($Profile.Name ,&quot;Admin&quot;)),
NOT($Profile.Name = &quot;Finance Approver&quot;)
)</errorConditionFormula>
    <errorMessage>The Opportunity cannot be edited after the Opportunity has been signed or while it is pending approval.</errorMessage>
</ValidationRule>
